"use strict";var author={},viewDetail={},previewImgList=[],view_content="",likeAmount=0,recommendList=[],commentList={},commentTotal=0,showFollow=!1,isFollow=0,isLike=0,isCollect=0,isDigg=0,view_id="",author_id="",isblock="none",isOpenShare=!1,isShareListMask="none",url=window.location.href,weiboUrl="",downFlag=!0,sw=!0,last_id=0,isWechat=!1,bottomText="",pageSize=3,showCommentLayer=!1,commentContent="",showReplyLayer=!1,replyContent="",replyingComment={},bodyw=document.body.clientWidth,subCommentSwitchState=!0,subCommentLikeSwitchState=!0,subPostCommentReplyState=!0,coverdivState=!0,loginWrapState=!1;function goSearchPage(t){}function initData(){view_id=util.getQueryString("articleid"),resetData(),fetchRecommendList(),fetchCommentList()}function resetData(){commentList={},isCollect=isLike=isFollow=likeAmount=0,isOpenShare=!(isblock="none"),isShareListMask="none",url=window.location.href,sw=downFlag=!0,last_id=0,bottomText=""}function onScrollPull(t){if(document.querySelector(".vf-detail_container__evaulate")){var e=document.querySelector(".vf-detail_container__evaulate").clientHeight;document.querySelector(".vf-bottom-tps");e<=(document.body.scrollTop||document.documentElement.scrollTop)+document.documentElement.clientHeight&&sw&&downFlag&&(sw=!1,0!=last_id&&fetchCommentList(last_id))}}function fetchViewDetail(){util.ajaxGet("/api/view/detail?view_id="+view_id).then(function(t){if(1==t.code){coverdivState=!1;var e=(viewDetail=t.data).view_content.replace(/<\/?.+?>/g,"").replace(/ /g,"").substr(0,100);$("head").append('<meta name="description" content="'+e+'" />').append('<meta name="keywords" content="V房，V房网，房产大V，饭总选房，北京买房，购房买房，房产资讯，北京房产" />'),$("title").html(viewDetail.view_title),viewDetail.label&&0<viewDetail.label.length?($(".taglist").show().html(""),viewDetail.label.split(",").forEach(function(t){var e=$("<li>").addClass("tagitem").text(t).click(function(){});$(".taglist").append(e)})):$(".taglist").hide(),viewDetail.view_title?$("#view_title").show().html(viewDetail.view_title):$("#view_title").hide().html(""),view_content=t.data.view_content.replace(/\s\s+/g,function(t){return new Array(t.length+1).join("&nbsp;")}),$("#viewContent").html(view_content),document.querySelectorAll(".emArticleLoop").forEach(function(t){t.style.color="#36577D",t.style.fontStyle="normal",t.style.textDecoration="underline",t.style.cursor="pointer",t.addEventListener("click",function(t){},!1)});var i=new Date(viewDetail.publish_time);i=i.getFullYear()+"-"+(9<i.getMonth()+1?i.getMonth()+1:"0"+(i.getMonth()+1))+"-"+(9<i.getDate()?i.getDate():"0"+i.getDate()),viewDetail.publish_time=i,viewDetail.publish_time?$("#publish_time").show().text(viewDetail.publish_time):$("#publish_time").hide().text(""),author_id=t.data.author_id,fatchAuthor(),authFollowStatus(),setTimeout(function(){$(".loadingContainer").hide()},500)}else t.code})}function fatchAuthor(){util.ajaxGet("/api/author/detail?author_id="+author_id).then(function(t){if(t&&1==t.code){var e='<img src="./images/default_user_img.png" />';(author=t.data).author_avatar&&(e='<img src="'+author.author_avatar+'?x-oss-process=image/resize,m_fill,h_200,w_200,limit_0" alt="">'),$(".dvhead,.V-pic").html(e),author.desc?($("#authorDesc").show().find("span").text(author.desc),$("#noAuthorDesc").hide()):($("#authorDesc").hide().find("span").text(""),$("#noAuthorDesc").show()),$("#author_name,.author_name").text(author.author_name)}})}function fetchStatistic(){util.ajaxGet("/api/view/statistics/list?view_id_list="+view_id).then(function(t){t&&((likeAmount=0<(likeAmount=t.data[0].like_amount)?99<likeAmount?"99+":likeAmount:"")?$(".likeAmount").show().text(likeAmount):$(".likeAmount").hide().text(""))})}function fetchRecommendList(){util.ajaxGet("/api/view/recommend/list?view_id="+view_id).then(function(t){t&&((recommendList=t.data)&&0<recommendList.length?($(".vf-detail_container__otherV").show().children("ul").html(""),recommendList.forEach(function(t){var e=$("<li>").click(function(){goDetail(t.view_id)}),i=$("<a>").attr("href","javascript:;").text(t.view_title);e.append(i),$(".vf-detail_container__otherV").children("ul").append(e)})):$(".vf-detail_container__otherV").hide().html(""))})}function _recursionReply(t,n){var a=[];return t.forEach(function(t,e){var i={};for(var o in t)t.hasOwnProperty(o)&&"reply"!==o&&(i[o]=t[o]);i.contentFmt=i.content+(n?"//@"+n:""),a.push(i),a=a.concat(_recursionReply(t.reply,t.user_name+":"+t.content))}),a}function fetchCommentList(){var n=last_id;util.ajaxGet("/api/comment/list?view_id="+view_id+"&&last_id="+last_id+"&&page_size="+pageSize).then(function(t){if(1==t.code){if(commentTotal=t.data.total_count){var e=99<commentTotal?"99+":commentTotal+"";$("#commentListTotal").show().text(e),$(".comm-none").hide()}else $("#commentListTotal").hide().text(""),$(".comm-none").show();if(t.data.comment_list&&0<t.data.comment_list.length){t.data.comment_list=t.data.comment_list.map(function(t,e){return t.publish_time=util.formatDate(t.publish_time),t.user_avatar=t.user_avatar||t.user_head,t.reply=_recursionReply(t.reply||[]).sort(function(t,e){return 0-((t.publish_time||0)-(e.publish_time||0))}),t.userReplay="",t.showReplay=!1,t}),0==last_id?commentList=t.data:commentList.comment_list=commentList.comment_list.concat(t.data.comment_list);var i=t.data.comment_list.length-1;last_id=t.data.comment_list[i].comment_id,sw=!0}if(bottomText=!t.data.comment_list||t.data.comment_list.length<pageSize||t.data.comment_list.length==pageSize&&commentList.comment_list.length==t.data.total?(downFlag=!1,0==n?"":"您太勤奋了，没有更多了"):(downFlag=!0,"加载中"),0<commentTotal){var o="";t.data.comment_list.forEach(function(t){o+='<div class="evaulate-list">\n                           <div class="pic">',t.user_avatar?o+='<img src="'+t.user_avatar+'">':o+='<img src="./images/default_user_img.png">',o+='</div>\n                           <div class="info">\n                               <div class="info-content">',t.user_name&&(o+="<p>"+t.user_name+"</p>"),t.content&&(o+='<p onclick="showReplayInput('+t.comment_id+","+view_id+')">'+t.content+"</p>"),o+='<div class="detail clearfix">\n                                       <span class="times">'+t.publish_time+'</span>\n                                       \x3c!--评论点赞--\x3e\n                                       <span class="nums" onclick="postCommentLike('+t.comment_id+", "+t.is_like+","+view_id+')">',t.is_like?o+='<svg class="icon on" aria-hidden="true">\n                                          <use xlink:href="#icon-thumbs-up-color1"></use>\n                                        </svg>':o+='<svg class="icon" aria-hidden="true">\n                                        <use xlink:href="#icon-thumbs-up"></use>\n                                    </svg>',o+=(99<t.like_amount?"99+":t.like_amount+"")+'\n                                       </span>\n                                       \x3c!--回复评论按钮--\x3e\n                                       <span class="message" onclick="showReplayInput('+t.comment_id+')">\n                                           <svg class="icon" aria-hidden="true">\n                                               <use xlink:href="#icon-message-square"></use>\n                                           </svg>\n                                           '+(99<t.reply.length?"99+":t.reply.length+""),(t.reply&&0<t.reply.length||t.showReplay)&&(o+="<i></i>"),o+="</span>\n                                   </div>",t.reply&&0<t.reply.length&&(o+='<div class="return-message">\n                                    \x3c!--回复列表--\x3e',t.reply&&0<t.reply.length&&t.reply.forEach(function(t){o+='<div class="return-message_list">\n                                            <em>'+t.user_name+'：</em>\n                                            <em onclick="showReplayInput('+t.reply_id+","+view_id+')">'+t.contentFmt+"</em>\n                                        </div>"}),o+="</div>"),o+="</div>\n                           </div>\n                       </div> "}),$(".vf-detail_container__evaulate").append(o)}0<bottomText.length?($(".vf-bottom-tps").show(),$(".vf-bottom-tps_line").children("span").text(bottomText)):($(".vf-bottom-tps").hide(),$(".vf-bottom-tps_line").children("span").text(""))}})}function postFollow(){loginWrapState=!0,setTimeout(function(){},1e3)}function postLike(t){}function postCollect(t){}function authFollowStatus(){util.ajaxGet("/api/author/follow_status?author_id="+author_id).then(function(t){t&&1==t.code&&(isFollow=t.data+0),(showFollow=!0)?$(".showFollow").show():$(".showFollow").hide(),1==isFollow?($(".isFollow").show(),$(".noIsFollow").hide()):($(".isFollow").hide(),$(".noIsFollow").show())})}function fetchActionStatus(){util.ajaxGet("/api/view/action_status?view_ids="+view_id).then(function(t){1==t.code?(isLike=t.data[0].like+0,isDigg=0!=isLike?1:0,(isCollect=t.data[0].collect+0)?($("#isCollect").show(),$("#noIsCollect").hide()):($("#isCollect").hide(),$("#noIsCollect").show())):isDigg=0,isDigg?($("#isDigg").show(),$("#noIsDigg").hide()):($("#isDigg").hide(),$("#noIsDigg").show())})}function goLargeVipDetail(){}function clickComment(){}function goDetail(t){window.open("./detail.html?articleid="+t,"_self")}function backToHome(){window.open("http://www.vfanghao.com","_self")}function showReplayInput(t,e){}function postCommentLike(t,e,i){}$(function(){window.addEventListener("scroll",this.onScrollPull),initData(),$(".header-left,.floatBtnToHome").click(function(){backToHome()}),$("#author_name,#davFocus").click(function(){}),$(".isFollow,.noIsFollow").click(function(){}),$("#isDigg,#noIsDigg").click(function(){}),$(".detail-footer_left,.detail-footer_right").click(function(){}),$("#postCollect").click(function(){}),$(".comm-none").children("a").click(function(){})});